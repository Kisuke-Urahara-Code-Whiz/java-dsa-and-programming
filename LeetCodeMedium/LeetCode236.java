package LeetCodeMedium;

import Programs.TreeNode;

public class LeetCode236 extends TreeNode {

    public TreeNode lowestCommonAncestor(TreeNode root, TreeNode p, TreeNode q) {
        TreeNode lca = null;
        if(root==null)
            return null;
        else if(p==null && q==null)
            return null;
        if(p==root || q==root)
            lca = root;

        TreeNode left = lowestCommonAncestor(root.left,p,q);
        TreeNode right = lowestCommonAncestor(root.right,p,q);

        if(left!=null && right!=null) return root;
        else if(left==null && right==null) return lca;
        else if(right==null) return lca==null?left:lca;
        else return lca==null?right:lca;

    }


    public static void main(String[] args) {
        LeetCode236 obj = new LeetCode236();
        TreeNode root = obj.buildTree(new Integer[]{42,10,11,60,65,50,98,66,84,35,97,-6,null,-1,73,2,61,8,20,-9311,21,13,-4502,88,89,6228,59,-7468,5042,null,81,-7,12,-6538,-5,82,-8,96,44,58,91,31,2999,29,3,93,74,null,null,-2084,-4,-1817,55,85,2581,52,18,null,null,5672,6,-5237,8156,-7683,516,null,null,-6313,null,1335,null,7,9394,null,-9,57,32,94,2242,4944,-6815,2084,8802,-8037,54,15,75,813,1027,-1396,-902,5752,null,-2,-764,24,5308,95,null,null,47,null,null,79,null,36,635,4661,86,9,5,-3385,92,4832,83,76,-7959,478,4133,1,4735,72,7258,43,0,null,38,41,40,-4782,4845,1152,62,-3634,3532,4,-3,25,1475,19,-1788,null,316,37,67,4249,-3414,-5174,39,-4216,2809,64,273,null,null,26,7139,-7173,99,null,-2643,77,16,6982,2842,null,null,null,-8345,null,78,4153,5173,-443,-1781,-520,8199,46,14,null,null,6062,8358,null,null,-1055,null,-9472,-7501,-4573,2507,5047,5040,80,1790,-1366,6527,-757,-9678,53,70,-2340,7260,null,56,null,null,33,null,1716,71,-9850,-9877,-6126,-6321,-1015,null,null,null,1371,4820,-6392,17,null,-7372,-9647,-9197,1489,-185,-9131,49,null,8642,null,-4023,null,-2028,4438,2558,-1296,3215,null,null,-1146,-8974,7752,null,4089,6543,-6750,-9581,null,null,null,null,4407,null,-4561,-6720,9092,-4019,null,null,3318,-9208,-1229,8491,-6150,63,null,3942,null,9425,34,-7257,7608,null,null,null,null,-7941,6569,-7970,4651,-2739,7064,27,null,null,-9722,null,null,null,7400,68,null,null,null,4909,null,null,4755,null,null,-730,267,null,30,-7787,1121,9846,1501,22,-4911,-1441,-5842,null,-1680,-2374,-759,7976,3166,48,null,7046,-4241,-9485,8071,8273,-5784,3061,8846,-6700,-762,-7540,-3201,null,69,null,-7745,null,null,null,null,null,-7421,null,null,null,-952,9455,-6839,9277,-9173,-6842,-7355,-9533,null,null,null,7310,-8928,null,null,5382,155,28,null,null,1492,-3074,-8760,614,null,null,null,7353,-6609,-9673,null,null,null,-4883,null,-6511,null,-7376,null,918,null,797,9766,null,-7397,-6135,-7213,-2054,4833,-3731,null,8601,null,9895,9288,8058,null,null,null,null,8505,null,null,746,-2947,-6569,-2204,9274,null,null,-8786,5835,-9379,6955,-4548,1903,-7226,null,4214,null,null,-4192,4619,8606,663,7740,null,null,null,null,null,null,null,null,null,5927,-5543,null,-8581,2340,-9717,null,277,-8864,90,null,-4780,null,null,87,null,null,null,null,null,null,null,null,null,4154,null,null,3537,null,-1159,601,-2802,null,7182,-1522,7490,null,2984,4460,-7526,-4459,null,null,null,null,null,null,null,3824,null,-8887,7753,-7486,-1923,-6377,8812,null,535,null,null,null,-7631,3420,7165,4390,6977,null,-9198,1583,4507,9634,-4621,8316,6138,null,null,null,-1026,4222,-7316,-7082,-7262,null,1097,null,1930,-147,6995,-1047,-9767,-3794,null,-2254,4515,-1955,-7076,-6858,9793,null,4753,3040,-2624,null,-3001,-8895,null,null,null,null,null,null,null,null,null,-8520,null,null,6023,null,9324,null,null,null,null,null,null,null,-8816,null,null,null,4578,-1178,null,null,null,-5279,-6137,4622,null,null,51,null,9085,-1963,-1286,-8971,-4042,243,6990,6943,-3700,1980,-9249,1960,null,3467,8374,null,null,null,null,null,null,null,null,null,null,-8397,-9438,1954,null,null,1997,-8922,-7547,-4955,6378,null,-6710,6583,554,2822,8861,4672,null,null,null,-5192,-8536,-5675,null,null,-760,null,1568,7272,2079,null,-1172,-8820,null,9666,null,-582,null,null,null,-1904,null,null,null,-4444,-2526,null,2728,8498,-7225,null,null,null,null,null,-6413,745,9763,3471,5339,5296,-8640,2245,7533,7911,-9459,-9870,null,null,null,null,8277,-964,null,7178,8502,-2497,null,5324,5871,null,null,801,null,9045,null,null,5590,-5111,null,null,4459,null,-2557,null,1641,-693,null,4266,null,null,-7050,5140,-2539,-7880,null,1788,-7293,6238,8871,404,4731,9115,null,null,null,7114,5891,-8033,null,-9336,869,-4983,null,null,null,null,-4609,135,-8040,-6619,-8675,-1012,6837,3189,8631,366,3434,3635,-9381,-1459,3332,-275,-2508,null,-903,-5368,null,null,null,null,null,-6958,null,4416,null,null,1118,-2433,1701,-1624,23,null,null,null,4372,null,null,null,4597,-1356,1490,7085,null,null,null,null,null,null,4774,null,null,-681,null,null,5667,-1070,6351,-3851,-8322,5881,4537,-2071,-7000,null,-9216,2388,-3129,null,6367,-2034,null,null,3302,8394,null,null,7745,-7239,-4687,-6729,null,-8375,3368,7562,5005,null,-3872,-9862,4722,-4090,8515,217,7128,8451,-6661,-4901,null,null,null,null,null,null,null,null,-7171,2307,1556,1941,8439,null,null,-4700,null,null,7373,-3469,null,7108,-3106,5867,7540,null,null,null,null,null,null,null,6960,-4818,null,null,7203,null,null,8302,null,null,null,null,null,null,null,6636,-965,null,454,null,-6884,null,8933,null,5951,8298,null,null,null,null,-8349,-6931,7841,4353,-3948,-4666,null,null,null,2436,null,null,null,4498,4306,-9883,-6217,null,-3940,8475,null,null,4236,null,7793,null,null,null,4195,9971,-6510,null,null,1723,null,null,null,-2022,-4785,1892,-8530,null,-8434,-905,-2330,-3559,null,null,null,null,-9070,-5526,-7146,-3036,6221,-2106,-273,null,-9623,8540,8557,-4784,3210,-2675,-4312,null,null,null,null,null,null,null,45,null,null,null,null,null,8489,null,null,null,null,-2963,null,null,null,null,7229,null,-6857,9606,null,null,5472,4793,-3654,-2015,null,6370,-8271,-2399,null,null,null,null,null,5295,-853,6922,117,null,null,1158,-7149,null,null,-5986,6652,null,-1883,2356,-8005,1285,null,null,null,null,null,6514,null,null,null,null,9191,-1862,6938,9473,-7140,-217,null,null,7624,9558,5508,null,null,null,5569,312,-2440,3075,1377,8939,null,null,5739,4786,null,-6543,null,4219,-9309,-9350,null,7460,2616,9664,2648,2535,null,-6823,6389,null,null,2171,null,null,null,null,null,null,null,null,9827,null,1007,-7972,3909,6897,7842,3866,6051,null,-3163,-6743,5452,null,-6140,null,null,2349,null,-5571,6419,null,null,null,5027,1201,null,null,-5007,5546,null,-5546,-3238,2622,null,null,null,null,null,7299,null,null,2379,null,null,null,null,null,2762,-9645,null,null,null,null,null,null,null,null,-7751,null,null,null,-4592,5065,null,null,null,8419,null,null,null,4345,6204,212,-2404,null,null,-6358,6976,-6940,-795,null,-6785,-6203,null,9440,null,null,-845,null,226,-8024,null,null,null,-530,null,null,-6698,1986,null,null,null,null,null,null,null,null,null,null,8966,null,-6855,null,null,null,-1601,null,null,null,5465,-4044,null,-9252,-9033,8506,-9796,314,-8317,-6101,null,-9190,null,null,null,1398,null,4307,-3640,8535,null,null,null,null,null,6363,null,null,null,-2091,null,null,-5071,7862,-2059,null,null,-6141,null,null,4831,1817,null,null,null,null,856,null,null,1504,null,null,null,null,null,null,4393,8279,null,null,6202,9364,null,null,-1433,7843,5882,514,null,5756,null,4668,1287,null,null,1278,null,null,null,null,null,null,9408,null,null,null,5631,null,null,null,-8049,6175,612,5662,5957,4601,null,2111,null,null,null,null,null,null,null,-8697,-8245,null,null,null,-1259,1837,-6241,7192,null,null,null,null,null,null,6908,null,9681,2166,null,3133,null,null,-2104,-4952,null,-959,-5786,4756,3008,5398,null,null,null,null,null,null,2933,null,null,null,null,5811,null,null,null,null,-6090,-6177,null,null,null,null,3468,8108,-6325,null,7840,null,126,null,null,null,null,null,null,null,null,2816,null,null,null,null,3142,null,null,null,null,-5585,6870,null,null,7801,null,null,5526,-2804,1116,null,null,null,-896,9216,null,null,-4197,null,null,9899,-7382,9130,1350,-8174,985,null,null,null,-8346,null,null,null,null,null,null,null,null,null,7259,-391,null,null,null,null,null,null,null,null,-3933,5831,null,null,null,null,-2842,-1840,-4593,null,null,null,null,null,-3713,null,null,null,9825,6492,null,null,-9708,-7345,3132,-4504,null,null,-6534,null,null,null,-2989,-5522,null,3692,-3176,null,null,null,null,null,null,null,null,null,3691,null,null,null,null,-5655,null,null,-1597,1164,null,null,8564,-7654,7930,480,7775,-8506,null,null,3108,null,null,null,null,null,null,null,-9461,498,3938,5928,null,-6582,null,null,1373,null,null,null,-7210,null,6651,-4755,-3786,null,null,-814,5191,-9968,null,null,null,null,4704,null,3803,-9189,7663,null,null,null,null,null,-9352,null,-3026,-2585,-3019,null,null,null,null,null,null,null,3107,-3907,null,null,1586,-2836,null,6427,null,7073,null,null,8474,null,-2027,5107,null,-4335,7657,null,-8402,null,2347,-3357,-5990,-917,null,5475,null,null,8634,null,-2317,null,null,null,-3809,null,null,8569,null,-1919,null,null,-4238,null,null,null,-9664,null,null,5450,-4039,-4761,null,3599,-2981,null,null,null,null,null,null,null,null,null,null,-3105,null,null,null,null,null,null,-7189,777,null,null,null,null,null,8870,null,null,null,6156,null,null,-7093,null,-6431,7788,null,9651,-8219,null,null,null,null,null,null,null,-7910,null,3084,-1221,7518,null,null,null,null,960,-9467,3793,null,null,null,-9164,null,null,-235,null,7765,null,null,-5280,null,null,-1312,null,-2999,null,null,null,null,null,-8054,-1828,null,4538,null,null,null,null,2470,null,null,null,null,3459,null,null,-9974,4815,477,-8184,null,-1482,null,-3724,-7812,-6748,null,9220,null,null,null,null,null,null,null,null,-526,null,null,null,8909,null,null,null,-9674,-1969,null,null,null,-754,-5855,null,9685,null,null,-4606,null,-1929,null,686,null,null,null,null,null,null,null,-6023,null,null,null,null,null,null,2192,8268,null,null,5067,3660,null,null,-7275,3829,-2910,null,null,null,null,null,null,9357,null,-9091,null,null,null,null,-3150,-8651,4431,9313,null,-5672,null,-1977,4817,null,null,-4823,null,null,null,null,-5156,null,null,-9105,null,-2990,null,null,null,null,null,-910,null,null,null,null,-2343,-9150,-4183,null,null,1735,null,null,4901,3939,null,null,null,null,-1592,6356,9872,null,null,3711,-8169,-4732,-4888,null,null,1791,null,null,null,null,-6535,null,null,null,null,null,null,null,null,-3248,null,null,null,null,null,null,null,null,8180,null,null,null,null,null,null,null,null,null,null,null,-4611,null,8643,null,null,null,null,null,-4445,null,null,null,null,null,null,6880,9911,null,null,1442,null,null,null,null,-4151,1286,null,null,null,null,null,null,7001,1801,null,null,7738,null,-7295,null,null,null,null,null,null,null,-5828,null,null,null,null,null,null,-1962,6865,-8447,-75,null,null,null,null,null,null,null,null,null,null,-6064,null,null,5035,null,null,7020,null,null,null,null,null,null,null,-8714,null,4058,9839,null,null,null,2253,null,null,null,null,null,null,null,null,null,null,null,null,null,null,-8696,null,1399,null,-2634,null,6445,null,-8426,-3383,null,null,3676,null,null,null,null,null,null,null,null,null,null,null,null,null,null,558});
        System.out.println("LCA -> "+obj.lowestCommonAncestor(root,root.left.right,root.right).val);
    }
}
